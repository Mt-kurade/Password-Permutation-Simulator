<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Password Permutation Simulator — Order Matters</title>
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;500;700&display=swap" rel="stylesheet">
<style>
  :root{
    --bg1:#e6f0ff;
    --bg2:#f3f6ff;
    --card:#fff;
    --accent:#4f46e5;
    --muted:#64748b;
    --good:#16a34a;
    --warn:#f59e0b;
    --bad:#ef4444;
  }
  *{box-sizing:border-box}
  body{
    font-family:'Poppins',sans-serif;
    margin:0;
    background:linear-gradient(135deg,var(--bg1),var(--bg2));
    padding:28px;
    color:#0f172a;
    display:flex;
    align-items:flex-start;
    justify-content:center;
    gap:20px;
    min-height:100vh;
  }
  .container{width:100%;max-width:1100px;display:grid;grid-template-columns:1fr 420px;gap:22px}
  .card{
    background:var(--card);
    border-radius:16px;
    padding:18px;
    box-shadow:0 8px 30px rgba(8,15,52,0.08);
  }
  h1{margin:0 0 6px;font-size:20px}
  p.lead{margin:0 0 14px;color:var(--muted);font-size:14px}
  label{display:block;margin-top:8px;font-weight:600;color:#0b1220}
  input[type="number"], select, button{
    width:100%;padding:10px;border-radius:10px;border:1px solid #e6eef8;margin-top:6px;font-size:14px;
  }
  .row{display:flex;gap:10px}
  .small{font-size:13px;color:var(--muted)}
  button.primary{background:var(--accent);color:white;border:none;font-weight:700;cursor:pointer}
  .muted{color:var(--muted);font-size:13px}
  .result-block{margin-top:12px;padding:12px;border-radius:10px;background:linear-gradient(180deg,#fbfdff,#f7fbff);border:1px solid #eef5ff}
  .kb{font-family:monospace;background:#f1f7ff;padding:6px 8px;border-radius:6px}
  .gauge-wrap{display:flex;flex-direction:column;align-items:center;gap:10px;padding-top:6px}
  .bar {
    width:100%;height:16px;border-radius:10px;background:#e6eefb;overflow:hidden;border:1px solid #e7eefc;
  }
  .bar > .fill{height:100%;width:0%;transition:width 0.4s linear;background:linear-gradient(90deg,#34d399,#60a5fa);border-radius:10px;}
  .circular {width:160px;height:160px;position:relative}
  svg {transform:rotate(-90deg)}
  .center-label{position:absolute;left:0;right:0;top:0;bottom:0;display:flex;flex-direction:column;align-items:center;justify-content:center}
  .controls{display:flex;flex-direction:column;gap:8px;margin-top:8px}
  .muted-note{font-size:13px;color:var(--muted);margin-top:8px}
  .footer{font-size:12px;color:var(--muted);text-align:center;margin-top:10px}
  @media(max-width:940px){.container{grid-template-columns:1fr;}}
</style>
</head>
<body>
  <div class="container">
    <div class="card">
      <h1>Password Permutation Simulator</h1>
      <p class="lead">Demonstrates <strong>order matters</strong> (permutation) for passwords: calculate possibilities, estimated real-world crack time, preview a generated password, then run a compressed simulated attack to visualize how improbable a crack is for strong passwords.</p>

      <label>Character set</label>
      <select id="charsetSelect">
        <option value="26">Lowercase letters (26)</option>
        <option value="52">Upper+Lower (52)</option>
        <option value="62" selected>Upper+Lower+Digits (62)</option>
        <option value="94">Printable ASCII (94)</option>
        <option value="128">Extended (128)</option>
      </select>

      <div style="display:flex;gap:10px;margin-top:8px">
        <div style="flex:1">
          <label>Password length</label>
          <input id="pwLength" type="number" min="1" value="8">
        </div>
        <div style="width:160px">
          <label>Tries / sec</label>
          <select id="triesPerSec">
            <option value="1000">1k</option>
            <option value="100000">100k</option>
            <option value="1000000" selected>1M</option>
            <option value="1000000000">1B</option>
            <option value="1000000000000">1T</option>
          </select>
        </div>
      </div>

      <div class="row" style="margin-top:10px">
        <button class="primary" onclick="updateStats()">Update Stats</button>
        <button onclick="generatePreview()">Generate Preview</button>
        <button onclick="startSimulation()">Start Sim Attack</button>
      </div>

      <div class="result-block" id="statsBlock">
        <div><strong>Total possibilities (approx):</strong> <span id="possibilities" class="kb">—</span></div>
        <div style="margin-top:8px"><strong>Estimated time to crack @ tries/sec:</strong> <span id="crackTime" class="kb">—</span></div>
        <div style="margin-top:8px"><strong>Log10(possibilities):</strong> <span id="logPoss" class="kb">—</span></div>
        <div style="margin-top:8px"><strong>Preview password:</strong> <span id="previewPw" class="kb">—</span></div>
        <div style="margin-top:10px"><strong>Simulation:</strong></div>
        <div id="simInfo" class="muted" style="margin-top:6px">Not running</div>
      </div>

      <div style="margin-top:12px" class="muted-note">
        Simulation is <em>time-compressed</em> for demo purposes — it shows the relative speed and probability, not a real-time brute force run.
      </div>
    </div>

    <div class="card">
      <div style="display:flex;justify-content:space-between;align-items:center">
        <div>
          <h2 style="margin:0">Strength Gauge</h2>
          <div class="small muted">Visualizes log-scale strength (order matters: more length or larger charset = more permutations)</div>
        </div>
        <div style="text-align:right">
          <div class="small muted">Demo speed</div>
          <select id="demoSpeed" style="width:120px" onchange="demoSpeedChanged()">
            <option value="1">Normal</option>
            <option value="2">2x</option>
            <option value="5">5x</option>
            <option value="10" selected>10x</option>
          </select>
        </div>
      </div>

      <div style="display:flex;gap:14px;margin-top:14px;align-items:center">
        <div class="gauge-wrap" style="flex:0 0 180px">
          <div class="circular">
            <svg width="160" height="160" viewBox="0 0 160 160">
              <defs>
                <linearGradient id="g1" x1="0" x2="1" y1="0" y2="1">
                  <stop offset="0%" stop-color="#34d399"/>
                  <stop offset="60%" stop-color="#60a5fa"/>
                </linearGradient>
              </defs>
              <circle cx="80" cy="80" r="66" stroke="#eef2ff" stroke-width="20" fill="none"></circle>
              <circle id="gaugeArc" cx="80" cy="80" r="66" stroke="url(#g1)" stroke-width="20" stroke-linecap="round" stroke-dasharray="0 999" fill="none"></circle>
            </svg>
            <div class="center-label">
              <div id="gaugePct" style="font-weight:700;font-size:20px">0%</div>
              <div style="font-size:12px;color:var(--muted)">Strength</div>
            </div>
          </div>
          <div style="width:100%;margin-top:10px" class="bar">
            <div class="fill" id="linearFill"></div>
          </div>
        </div>

        <div style="flex:1">
          <div style="display:flex;gap:10px">
            <div style="flex:1">
              <div style="font-size:13px;color:var(--muted)">Simulated tries</div>
              <div id="simTries" class="kb">—</div>
            </div>
            <div style="flex:1">
              <div style="font-size:13px;color:var(--muted)">Chance found (so far)</div>
              <div id="simChance" class="kb">—</div>
            </div>
          </div>

          <div style="margin-top:12px">
            <div style="display:flex;justify-content:space-between">
              <div class="small muted">Progress</div>
              <div class="small muted"><span id="simTimer">00:00</span></div>
            </div>
            <div class="bar" style="margin-top:6px"><div class="fill" id="simProgress" style="background:linear-gradient(90deg,#fb7185,#f97316)"></div></div>
          </div>

          <div style="margin-top:14px" class="muted-note">
            Tip: increase charset & length to see strength shoot up. Choose higher tries/sec to model faster attackers.
          </div>
        </div>
      </div>

      <div class="footer">
        Math: log10(total) = length × log10(charset). Time = total / triesPerSec (log safe). Simulation compresses real time for the demo.
      </div>
    </div>
  </div>

<script>

function log10(x){ return Math.log10(x); }

function computeLogPoss(length, charsetSize){
  return length * Math.log10(charsetSize);
}

function formatScientificFromLog10(log10val){
  const mant = Math.pow(10, log10val - Math.floor(log10val));
  const exp = Math.floor(log10val);
  return mant.toFixed(3) + " × 10^" + exp;
}

function formatTimeFromLog10(log10Seconds){
  if (!isFinite(log10Seconds)) return "∞";

  if (log10Seconds < 6){
    const secs = Math.pow(10, log10Seconds);
    return humanFriendlySeconds(secs);
  }

  const log10SecondsToYears = log10Seconds - Math.log10(31536000);
  if (log10SecondsToYears < 3){
    return formatScientificFromLog10(log10Seconds) + " s (~" + (Math.pow(10, log10SecondsToYears)).toExponential(2) + " years)";
  } else {
    return formatScientificFromLog10(log10Seconds) + " s (~10^" + (log10SecondsToYears.toFixed(2)) + " years)";
  }
}

function humanFriendlySeconds(s){
  if (s < 1) return (s*1000).toFixed(2) + " ms";
  if (s < 60) return s.toFixed(2) + " sec";
  if (s < 3600) return (s/60).toFixed(2) + " min";
  if (s < 86400) return (s/3600).toFixed(2) + " hrs";
  if (s < 31536000) return (s/86400).toFixed(2) + " days";
  return (s/31536000).toFixed(2) + " years";
}

let simTimerInterval = null;
let simStartTime = null;
let simDuration = 8; 
let currentSim = {running:false, logPoss:0, logTriesPerSec:0, logSimulatedTries: -Infinity};

function updateStats(){
  const charset = parseFloat(document.getElementById('charsetSelect').value);
  const length = Math.max(1, parseInt(document.getElementById('pwLength').value) || 1);
  const triesPerSec = parseFloat(document.getElementById('triesPerSec').value) || 1e6;

  const logPoss = computeLogPoss(length, charset); 
  const logTries = Math.log10(triesPerSec); 
  const logSeconds = logPoss - logTries; 

  document.getElementById('logPoss').textContent = logPoss.toFixed(4);
  document.getElementById('possibilities').textContent = "~" + formatScientificFromLog10(logPoss);
  document.getElementById('crackTime').textContent = formatTimeFromLog10(logSeconds);

  const maxLog = 40; 
  let pct = Math.min(100, Math.max(0, (logPoss / maxLog) * 100));
  pct = Math.round(pct);
  document.getElementById('gaugePct').textContent = pct + "%";
  document.getElementById('linearFill').style.width = pct + "%";

  const hue = Math.round(120 * (pct/100)); 
  document.getElementById('linearFill').style.background = linear-gradient(90deg,hsl(${hue},85%,50%),hsl(${Math.max(0,hue-20)},70%,45%));
 
  const arc = document.getElementById('gaugeArc');
  const circumference = 2 * Math.PI * 66;
  const dash = (pct/100) * circumference;
  arc.setAttribute('stroke-dasharray', ${dash} ${circumference - dash});

  if (!currentSim.running){
    generatePreview(); 

  currentSim.logPoss = logPoss;
  currentSim.logTriesPerSec = Math.log10(triesPerSec);
  document.getElementById('simInfo').textContent = "Ready. Click 'Start Sim Attack' to run a compressed demo.";
}

function generatePreview(){
  const charset = parseInt(document.getElementById('charsetSelect').value);
  const length = Math.max(1, parseInt(document.getElementById('pwLength').value) || 1);
  
  const sets = {
    26: "abcdefghijklmnopqrstuvwxyz",
    52: "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ",
    62: "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789",
    94: ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789~!@#$%^&*()-_=+[]{}|;:',.<>?/\\\"`,
    128: (()=>{ let s=""; for(let i=0;i<128;i++) s+=String.fromCharCode(i<32?32:i); return s; })()
  };
  const chars = sets[charset] || sets[62];
  let pw = "";
  for(let i=0;i<length;i++) pw += chars.charAt(Math.floor(Math.random()*chars.length));
  document.getElementById('previewPw').textContent = pw;
}

function startSimulation(){

  stopSimulation();

  const charset = parseFloat(document.getElementById('charsetSelect').value);
  const length = Math.max(1, parseInt(document.getElementById('pwLength').value) || 1);
  const triesPerSec = parseFloat(document.getElementById('triesPerSec').value) || 1e6;
  const demoSpeed = parseFloat(document.getElementById('demoSpeed').value) || 10;


  const logPoss = computeLogPoss(length, charset);
  const logTriesPerSec = Math.log10(triesPerSec);
  const logSeconds = logPoss - logTriesPerSec; // log10(real seconds)

  const baseDemo = Math.min(12, Math.max(0.5, 0.5 + logSeconds)); // roughly ~log10(seconds)
  simDuration = Math.max(1, baseDemo / demoSpeed); // at least 1s
  // initial sim state
  currentSim.running = true;
  currentSim.logPoss = logPoss;
  currentSim.logTriesPerSec = logTriesPerSec;
  currentSim.logSimulatedTries = -Infinity;
  simStartTime = performance.now();
  document.getElementById('simInfo').textContent = Running sim (compressed). Demo length: ${simDuration.toFixed(2)} s.;

  updateSimUI(0);

  simTimerInterval = requestAnimationFrame(simStep);
}

function simStep(ts){
  if (!currentSim.running) return;
  const elapsed = (performance.now() - simStartTime) / 1000; // seconds
  const t = Math.min(elapsed, simDuration);
  // simulated tries = triesPerSec * (t/demoDuration * realSeconds) ??? No.
  // We want simulatedTries to reflect the fraction of the real-world cracking process implied by t.
  // We map demo elapsed [0, simDuration] to fraction f of total real world time:
  // f = t / simDuration, simulatedElapsedSeconds = f * realEstimatedSeconds (realEstimatedSeconds = 10^(logPoss-logTries))
  // But realEstimatedSeconds may be astronomically big; rather compute logSimTries = logTriesPerSec + log(simulatedElapsedSeconds)
  // -> log(simulatedElapsedSeconds) = log10(realEstimatedSeconds) + log10(f) - log10( realEstimatedSeconds / simulatedElapsedSeconds )... this is messy.
  // Simpler: show simulatedTries as triesPerSec * (10^(scaleFactor * f) - 1) mapped to 0..total. We'll implement a monotonic exponential progress so small f yields tiny tries.
  const f = t / simDuration; // 0..1
  // Map f to log fraction of total possibilities: log10(simulatedTrieFraction) = f * (log10(total) - (-6)) - 6
  // But better: treat progress percent as p = 1 - 10^( (1-f) * ( -maxLogProgress ) ) ... too complex.

  // Practical approach: compute "simulated log tries" as:
  // logSimTries = logTriesPerSec + log10( realSecondsSimulated )
  // where realSecondsSimulated = 10^(logSeconds) * (10^(f*alpha) - 1) / (10^alpha - 1)
  // To avoid heavy math, we'll map f to logSimTries linearly between -9 (very small) and logPoss (full)
  const minLog = Math.max(-12, currentSim.logTriesPerSec - 6); // minimum simulated tries
  const maxLog = currentSim.logPoss; // if reaches max => success
  const logSimTries = minLog + f * (maxLog - minLog);
  currentSim.logSimulatedTries = logSimTries;

  updateSimUI(t);

  if (elapsed >= simDuration){
    currentSim.running = false;
    document.getElementById('simInfo').textContent = "Simulation finished (demo). Real-world time is shown above.";
    cancelAnimationFrame(simTimerInterval);
    simTimerInterval = null;
    return;
  }
  simTimerInterval = requestAnimationFrame(simStep);
}

function updateSimUI(simElapsed){
  // simElapsed seconds in demo
  const logSimTries = currentSim.logSimulatedTries;
  const logPoss = currentSim.logPoss;
  const logTriesPerSec = currentSim.logTriesPerSec;

  // show simulated tries
  const triesText = (isFinite(logSimTries) && logSimTries > -9) ? formatScientificFromLog10(logSimTries) : "~0";
  document.getElementById('simTries').textContent = triesText;

  const logChance = logSimTries - logPoss;
  let chanceText = "≈0%";
  if (logChance > -6){
    // convert to percent safely
    const chance = Math.pow(10, logChance) * 100;
    chanceText = chance < 0.0001 ? chance.toExponential(2) + "%" : chance.toFixed(6) + "%";
  } else if (logChance > -12){
    chanceText = (Math.pow(10, logChance) * 100).toExponential(2) + "%";
  } else {
    chanceText = "< 1e-" + Math.abs(Math.floor(logChance)) + "%";
  }
  document.getElementById('simChance').textContent = chanceText;

  // progress bar: percent = fraction of (logSimTries relative to logPoss mapped 0..1)
  let pct = 0;
  if (isFinite(logSimTries)){
    pct = Math.max(0, Math.min(100, ((logSimTries - (currentSim.logTriesPerSec - 6)) / (logPoss - (currentSim.logTriesPerSec - 6))) * 100));
    pct = Math.round(pct);
  }
  document.getElementById('simProgress').style.width = pct + "%";

  const elapsed = simElapsed;
  const mm = Math.floor(elapsed / 60).toString().padStart(2,'0');
  const ss = Math.floor(elapsed % 60).toString().padStart(2,'0');
  document.getElementById('simTimer').textContent = ${mm}:${ss};
}

function stopSimulation(){
  if (simTimerInterval){
    cancelAnimationFrame(simTimerInterval);
    simTimerInterval = null;
  }
  currentSim.running = false;
}

function demoSpeedChanged(){ /* noop for now */ }

updateStats();
generatePreview();

</script>
</body>
</html>
